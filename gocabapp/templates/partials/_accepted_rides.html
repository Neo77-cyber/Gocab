{% for ride in accepted_rides %}
<div class="trip-card" data-ride-id="{{ ride.id }}">
    <div class="trip-header">
        <div class="trip-meta">
            <span class="trip-time">Accepted {{ ride.accepted_at|timesince }} ago</span>
            <span class="trip-distance">{{ ride.distance_km|floatformat:1 }} km</span>
        </div>
        <div class="trip-price">â‚¦{{ ride.total_fare|floatformat:2 }}</div>
    </div>
    
    <div class="trip-route">
        <div class="route-point pickup">
            <i class="fas fa-circle"></i>
            <div class="location">{{ ride.current_location }}</div>
        </div>
        <div class="route-line"></div>
        <div class="route-point dropoff">
            <i class="fas fa-map-marker-alt"></i>
            <div class="location">{{ ride.destination }}</div>
        </div>
    </div>
    
    <div class="trip-footer">
        <div class="passenger-info">
            <div class="passenger-avatar">
                {{ ride.passenger.first_name|first }}{{ ride.passenger.last_name|first }}
            </div>
            <div class="passenger-details">
                <div class="passenger-name">{{ ride.passenger.get_full_name|default:ride.passenger.username }}</div>
                <div class="passenger-contact">
                    <div class="passenger-phone">
                        <i class="fas fa-phone"></i> 
                        {% if ride.passenger.rider and ride.passenger.rider.phone_number %}
                            {{ ride.passenger.rider.phone_number }}
                        {% else %}
                            N/A
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="trip-actions">
            <form method="post" action="{% url 'start_trip' ride.id %}" class="inline-form">
                {% csrf_token %}
                <input type="hidden" name="ride_id" value="{{ ride.id }}">
                <button type="submit" class="start-btn">
                    <i class="fas fa-play"></i> Start Trip
                </button>
            </form>
            <form method="post" action="{% url 'cancel_ride' ride.id %}" class="inline-form">
                {% csrf_token %}
                <button type="submit" class="cancel-btn">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </form>
        </div>
    </div>
    
    <div class="trip-eta">
        <div class="eta-icon">
            <i class="fas fa-clock"></i>
        </div>
        <span class="eta-text">ETA to pickup: {{ ride.eta|default:"Calculating..." }}</span>
    </div>
</div>
{% empty %}
<div class="empty-state">
    <i class="fas fa-car-side"></i>
    <p>No rides ready to start</p>
</div>
{% endfor %}

{% if accepted_rides.has_other_pages %}
<div class="pagination" id="acceptedRidesPagination">
    {% if accepted_rides.has_previous %}
        <button class="page-link" data-page="{{ accepted_rides.previous_page_number }}" data-action="accepted">
            <i class="fas fa-chevron-left"></i> Previous
        </button>
    {% endif %}
    
    <div class="page-numbers">
        {% for num in accepted_rides.paginator.page_range %}
            {% if accepted_rides.number == num %}
                <span class="page-link current">{{ num }}</span>
            {% elif num > accepted_rides.number|add:'-3' and num < accepted_rides.number|add:'3' %}
                <button class="page-link" data-page="{{ num }}" data-action="accepted">{{ num }}</button>
            {% endif %}
        {% endfor %}
    </div>
    
    {% if accepted_rides.has_next %}
        <button class="page-link" data-page="{{ accepted_rides.next_page_number }}" data-action="accepted">
            Next <i class="fas fa-chevron-right"></i>
        </button>
    {% endif %}
</div>

<div class="pagination-info">
    Showing {{ accepted_rides.start_index }}-{{ accepted_rides.end_index }} of {{ accepted_rides.paginator.count }} accepted rides
</div>
{% endif %}